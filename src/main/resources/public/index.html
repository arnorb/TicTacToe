<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>TicTacToe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet/less" href="styles.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/1.4.1/less.min.js" type="text/javascript"></script>
    <!-- load bootstrap for nicer ui -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  </head>
  <body lang="is">

    <div class="container">
      <h1>Spilaðu Tic Tac Toe!</h1>

      <p>Spilari X byrjar</p>

      <form method="post" action="/add" class="form-inline" role="form">
        

          <div class="game-board clearfix center-block">
          
                <div class="parent-row0">
                  <span class="board-field row0 column0" data-value="0">&nbsp;</span>
                  <span class="board-field row0 column1" data-value="1">&nbsp;</span>
                  <span class="board-field row0 column2" data-value="2">&nbsp;</span>
                </div>
          
                <div class="parent-row1">
                  <span class="board-field row1 column0" data-value="3">&nbsp;</span>
                  <span class="board-field row1 column1" data-value="4">&nbsp;</span>
                  <span class="board-field row1 column2" data-value="5">&nbsp;</span>
                </div>
          
                <div class="parent-row2">
                  <span class="board-field row2 column0" data-value="6">&nbsp;</span>
                  <span class="board-field row2 column1" data-value="7">&nbsp;</span>
                  <span class="board-field row2 column2" data-value="8">&nbsp;</span>
                </div>
          
          </div>

      </form>
      <hr>
      <div id="results">
      </div>
    </div>

    <!-- load jquery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <!-- use ajax to submit form, retreive the result and display on the page -->
    <!-- use ajax to submit form, retreive the result and display on the page -->
       <script>
       $(document).ready(function() {

         var player = 1;

         $( ".board-field" ).click(function() {

           var x,
               selectedField = $(this);

           if (selectedField.text() != '×' && selectedField.text() != 'o' ) {
             if(player == 1){
               x = '×';
               player = 2;
             }
             else
             {
               x = 'o';
               player = 1;
             }
            
           }

           
           //$( this ).attr(value, player)
           selectedField.text(x);
           selectedField.addClass('not-allowed');

           send($( this ).attr('data-value')); 
         });
       });

         function send(i){

                 var val = i;
                 console.log  ("jallla:" + val);

                 $.ajax({
                   type: 'post',
                   url: '/add',
                   data: 'val=' + val
                 }).done(function(win) {
                   if (win != "")
                   $('#results').html(win).attr('class', 'alert alert-success');
                 }).fail(function() {
                   $('#results').html('Villa kom upp').attr('class', 'alert alert-danger');
                 });

         }

       </script>
  </body>
</html>